<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>اژدهای تعقیب‌کننده</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }

    svg {
      width: 100vw;
      height: 100vh;
    }

    .dragon-part {
      fill: limegreen;
      stroke: #00ff00;
      stroke-width: 2;
    }
  </style>
</head>
<body>
  <svg></svg>

  <script>
    const svg = d3.select("svg");
    const numParts = 20; // تعداد بخش‌های بدن اژدها
    const parts = [];

    // نقاط اولیه
    for (let i = 0; i < numParts; i++) {
      parts.push({ x: window.innerWidth / 2, y: window.innerHeight / 2 });
    }

    // رسم دایره‌های بدن اژدها
    const circles = svg.selectAll("circle")
      .data(parts)
      .enter()
      .append("circle")
      .attr("r", (d, i) => 20 - i * 0.7) // کوچکتر شدن از سر تا دم
      .attr("class", "dragon-part");

    let target = { x: window.innerWidth / 2, y: window.innerHeight / 2 };

    // حرکت دادن کل اژدها دنبال موس یا لمس
    svg.on("mousemove touchmove", function (event) {
      const pos = d3.pointer(event);
      target.x = pos[0];
      target.y = pos[1];
    });

    d3.timer(function () {
      // برای هر بخش، به سمت بخش قبلی حرکت کند
      for (let i = parts.length - 1; i > 0; i--) {
        parts[i].x += (parts[i - 1].x - parts[i].x) * 0.15;
        parts[i].y += (parts[i - 1].y - parts[i].y) * 0.15;
      }

      // سر به سمت هدف حرکت کند
      parts[0].x += (target.x - parts[0].x) * 0.2;
      parts[0].y += (target.y - parts[0].y) * 0.2;

      // به‌روزرسانی مکان دایره‌ها
      circles
        .attr("cx", d => d.x)
        .attr("cy", d => d.y);
    });
  </script>
</body>
</html>
