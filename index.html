<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web Code Runner</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #111;
      color: white;
    }
    header {
      background: #222;
      padding: 10px;
      text-align: center;
      font-size: 1.2em;
      border-bottom: 4px solid red;
    }
    #container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      height: 100vh;
    }
    #editors, #preview {
      padding: 10px;
      overflow: auto;
    }
    textarea {
      width: 100%;
      height: 100px;
      margin-bottom: 10px;
      background: #222;
      color: white;
      border: none;
      resize: vertical;
      padding: 8px;
      font-family: monospace;
    }
    iframe {
      width: 100%;
      height: 100%;
      background: white;
      border: 2px solid #555;
    }
    select, button {
      margin: 5px;
      padding: 10px;
      background: #444;
      color: white;
      border: none;
      cursor: pointer;
    }
    .buttons {
      text-align: center;
      margin: 10px;
    }
  </style>
</head>
<body>
  <header>🖥️ محیط اجرای کد آنلاین</header>
  <div class="buttons">
    <select id="language">
      <option value="html">HTML</option>
      <option value="python">Python</option>
      <option value="css">CSS</option>
      <option value="js">JavaScript</option>
    </select>
    <button onclick="runCode()">▶️ اجرای کد</button>
    <button onclick="downloadScreenshot()">📸 ذخیره عکس خروجی</button>
    <button onclick="recordVideo()">🎥 ذخیره ویدیو خروجی</button>
  </div>
  <div id="container">
    <div id="editors">
      <textarea id="html" placeholder="کد HTML...">
<h1>سلام دنیا!</h1></textarea>
      <textarea id="css" placeholder="کد CSS...">
body { background: lightblue; }</textarea>
      <textarea id="js" placeholder="کد JavaScript...">
console.log('JS فعال شد!')</textarea>
      <textarea id="python" style="display:none;" placeholder="کد Python...">
print('Hello from Python!')</textarea>
    </div>
    <div id="preview">
      <iframe id="output"></iframe>
    </div>
  </div>
  <script>
    const output = document.getElementById('output');function runCode() {
  const lang = document.getElementById('language').value;
  if (lang === 'python') {
    const pyCode = document.getElementById('python').value;
    output.srcdoc = `<pre style='color:lime;'>${pyCode.replace(/</g, '&lt;')}</pre>`;
  } else {
    const html = document.getElementById('html').value;
    const css = document.getElementById('css').value;
    const js = document.getElementById('js').value;
    const code = `
      <style>${css}</style>
      ${html}
      <script>${js}<\/script>
    `;
    output.srcdoc = code;
  }
}

function downloadScreenshot() {
  html2canvas(output.contentDocument.body).then(canvas => {
    const link = document.createElement('a');
    link.download = 'output.png';
    link.href = canvas.toDataURL();
    link.click();
  });
}

function recordVideo() {
  const stream = output.contentWindow.document.body.captureStream(30);
  const recorder = new MediaRecorder(stream);
  const chunks = [];
  recorder.ondataavailable = e => chunks.push(e.data);
  recorder.onstop = () => {
    const blob = new Blob(chunks, { type: 'video/webm' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'output.webm';
    link.click();
  };
  recorder.start();
  setTimeout(() => recorder.stop(), 90000); // 90 ثانیه ضبط
}

document.getElementById('language').addEventListener('change', (e) => {
  const show = e.target.value;
  ['html','css','js','python'].forEach(id => {
    document.getElementById(id).style.display = show === id ? 'block' : (show === 'python' ? (id === 'python' ? 'block' : 'none') : (id === 'python' ? 'none' : 'block'));
  });
});

  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</body>
</html>
