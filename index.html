<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>کد ادیتور با خروجی</title>
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      background-color: #1e1e1e;
      color: white;
      font-family: monospace;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem;
      background-color: #333;
    }
    .top-bar button {
      background-color: #444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      margin-left: 0.5rem;
      cursor: pointer;
      border-radius: 0.5rem;
    }
    .editor-container {
      display: flex;
      flex: 1;
      overflow: hidden;
    }
    textarea {
      flex: 1;
      padding: 1rem;
      background-color: #111;
      color: white;
      border: none;
      resize: none;
      outline: none;
    }
    iframe {
      flex: 1;
      border: none;
      background: white;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <span>🖥️ Code Editor</span>
    <div>
      <input id="durationInput" type="number" min="1" max="90" value="30" style="width: 60px; padding: 3px;"> ثانیه
      <button onclick="captureScreenshot()">📷 عکس خروجی</button>
      <button onclick="recordOutput()">🎥 ویدیو خروجی</button>
    </div>
  </div>
  <div class="editor-container">
    <textarea id="code" oninput="updatePreview()"><!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        background: #000;
        color: #0f0;
      }
    </style>
  </head>
  <body>
    <h1>Hello, world!</h1>
    <audio controls autoplay>
      <source src="your-audio.mp3" type="audio/mpeg">
    </audio>
  </body>
</html>
</textarea>
    <iframe id="preview"></iframe>
  </div>  <script>
    function updatePreview() {
      const iframe = document.getElementById('preview');
      const code = document.getElementById('code').value;
      iframe.srcdoc = code;
    }
    updatePreview();

    async function captureScreenshot() {
      const iframe = document.getElementById('preview');
      const canvas = await html2canvas(iframe.contentDocument.body);
      const link = document.createElement('a');
      link.download = 'screenshot.png';
      link.href = canvas.toDataURL();
      link.click();
    }

    async function recordOutput() {
      const iframe = document.getElementById('preview');
      const stream = iframe.contentWindow.document.querySelector('audio')?.captureStream?.() || iframe.contentWindow.document.body.captureStream?.();
      if (!stream) return alert("مرورگر شما ضبط را پشتیبانی نمی‌کند");
      const recorder = new MediaRecorder(stream);
      const chunks = [];
      recorder.ondataavailable = e => chunks.push(e.data);
      recorder.onstop = e => {
        const blob = new Blob(chunks, { type: 'video/webm' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'recording.webm';
        a.click();
      };
      recorder.start();
      const duration = Math.min(parseInt(document.getElementById('durationInput').value || '30'), 90);
      setTimeout(() => recorder.stop(), duration * 1000);
    }
  </script>  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script></body>
</html>
